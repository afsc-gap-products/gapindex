<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Standard AFSC GAP Product Calculations • gapindex</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Standard AFSC GAP Product Calculations">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">gapindex</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="gapindex-r-package">gapindex R Package<a class="anchor" aria-label="anchor" href="#gapindex-r-package"></a>
</h1></div>
<p>This R package generates design-based indices of biomass, abundance, size composition, and age composition from NOAA-NMFS-AFSC-RACE-GAP bottom trawl survey data. Survey regions include: Gulf of Alaska (from 1984), Aleutian Islands (from 1980), Eastern Bering Sea Shelf (from 1982), Eastern Bering Sea Slope (from 2002), and Northern Bering Sea Shelf (from 2010).</p>
<p>The <a href="https://github.com/afsc-gap-products/gap_products" class="external-link">gap_products</a> GitHub repository will store the code used to produce and test the standard data products for all regions each year calculated using the gapindex R package. Rollout of this new workflow is currently slated for Fall 2024.</p>
</div>
<div class="section level1">
<h1 id="example-workflow">Example Workflow<a class="anchor" aria-label="anchor" href="#example-workflow"></a>
</h1>
<p>Make sure you have installed R packages devtools, RODBC, and getPass and are connected to the AFSC network when using this package.</p>
<pre><code><span><span class="co">## Install package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"afsc-gap-products/gapindex"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gapindex</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Connect to Oracle</span></span>
<span><span class="va">sql_channel</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/get_connected.html">get_connected</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Pull data.</span></span>
<span><span class="va">gapindex_data</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/get_data.html">get_data</a></span><span class="op">(</span></span>
<span>  year_set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2007</span>, <span class="fl">2009</span><span class="op">)</span>,</span>
<span>  survey_set <span class="op">=</span> <span class="st">"GOA"</span>,</span>
<span>  spp_codes <span class="op">=</span> <span class="fl">10261</span>,   </span>
<span>  haul_type <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  abundance_haul <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  pull_lengths <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  sql_channel <span class="op">=</span> <span class="va">sql_channel</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Fill in zeros and calculate CPUE</span></span>
<span><span class="va">cpue</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/calc_cpue.html">calc_cpue</a></span><span class="op">(</span>racebase_tables <span class="op">=</span> <span class="va">gapindex_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate stratum-level biomass, population abundance, mean CPUE and </span></span>
<span><span class="co">## associated variances</span></span>
<span><span class="va">biomass_stratum</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/calc_biomass_stratum.html">calc_biomass_stratum</a></span><span class="op">(</span></span>
<span>  racebase_tables <span class="op">=</span> <span class="va">gapindex_data</span>,</span>
<span>  cpue <span class="op">=</span> <span class="va">cpue</span>,</span>
<span>  vulnerability <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate aggregated biomass and population abundance across subareas,</span></span>
<span><span class="co">## management areas, and regions</span></span>
<span><span class="va">biomass_subareas</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/calc_biomass_subarea.html">calc_biomass_subarea</a></span><span class="op">(</span></span>
<span>  racebase_tables <span class="op">=</span> <span class="va">gapindex_data</span>,</span>
<span>  biomass_strata <span class="op">=</span> <span class="va">biomass_stratum</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate size composition by stratum. See ?gapindex::calc_sizecomp_stratum</span></span>
<span><span class="co">## for details on arguments</span></span>
<span><span class="va">size_comp_stratum</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/calc_sizecomp_stratum.html">calc_sizecomp_stratum</a></span><span class="op">(</span></span>
<span>  racebase_tables <span class="op">=</span> <span class="va">gapindex_data</span>,</span>
<span>  racebase_cpue <span class="op">=</span> <span class="va">cpue</span>,</span>
<span>  racebase_stratum_popn <span class="op">=</span> <span class="va">biomass_stratum</span>,</span>
<span>  spatial_level <span class="op">=</span> <span class="st">"stratum"</span>,</span>
<span>  fill_NA_method <span class="op">=</span> <span class="st">"AIGOA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate aggregated size compositon across subareas, management areas, and</span></span>
<span><span class="co">## regions</span></span>
<span><span class="va">size_comp_subareas</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/calc_sizecomp_subareas.html">calc_sizecomp_subareas</a></span><span class="op">(</span></span>
<span>  racebase_tables <span class="op">=</span> <span class="va">gapindex_data</span>,</span>
<span>  size_comps <span class="op">=</span> <span class="va">size_comp_stratum</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate age-length key. See ?gapindex::calc_ALK for details on arguments</span></span>
<span><span class="va">alk</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/calc_ALK.html">calc_ALK</a></span><span class="op">(</span>racebase_tables <span class="op">=</span> <span class="va">gapindex_data</span>, </span>
<span>                          unsex <span class="op">=</span> <span class="st">"all"</span>, </span>
<span>                          global <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate age composition by stratum</span></span>
<span><span class="va">age_comp_stratum</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/calc_agecomp_stratum.html">calc_agecomp_stratum</a></span><span class="op">(</span></span>
<span>  racebase_tables <span class="op">=</span> <span class="va">gapindex_data</span>, </span>
<span>  alk <span class="op">=</span> <span class="va">alk</span>,</span>
<span>  size_comp <span class="op">=</span> <span class="va">size_comp_stratum</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate aggregated age compositon across regions</span></span>
<span><span class="va">age_comp_region</span> <span class="op">&lt;-</span> <span class="fu">gapindex</span><span class="fu">::</span><span class="fu"><a href="reference/calc_agecomp_region.html">calc_agecomp_region</a></span><span class="op">(</span></span>
<span>  racebase_tables <span class="op">=</span> <span class="va">gapindex_data</span>, </span>
<span>  age_comps_stratum <span class="op">=</span> <span class="va">age_comp_stratum</span><span class="op">)</span></span></code></pre>
<div class="section level2">
<h2 id="in-progress">In progress<a class="anchor" aria-label="anchor" href="#in-progress"></a>
</h2>
<ul>
<li>@MargaretSiple-NOAA created a <a href="https://github.com/zoyafuso-NOAA/design-based-indices/tree/master/old_scripts/vignettes" class="external-link">vignette</a> on the biomass calculations using equations (from <a href="https://drive.google.com/file/d/1m5c1N4WYysM1pscrpcgWOGZSZIK8vIHr/view?usp=sharing" class="external-link">Wakabayashi et al. 1985</a>. We should make this into a wiki and have different pages for the different calculations (biomass, age compositions, etc.), assumptions, peculiarities, etc.</li>
<li>Increased documentation of function output similar to the metadata associated with GAP_PRODUCTS tables.</li>
<li>Standardize data pulling process for ModSquad model-based index production</li>
<li>Establish production cycle for standard gap products</li>
<li>Formalize documentation of any changes that occur in the standard data products after each production cycle.</li>
<li>Create a Tech Memo that describes the changes in the Oracle data infrastructure in tandem with the creation of the gapindex package.</li>
</ul>
</div>
<div class="section level2">
<h2 id="collaborators">Collaborators<a class="anchor" aria-label="anchor" href="#collaborators"></a>
</h2>
<p>The gapindex R package is a product of two AFSC-RACE-GAP working groups regarding GAP data processes and index computation. Many thanks to those who participated in those working groups:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center"><strong>Data Processes Working Group</strong></th>
<th align="center"><strong>Index Computation Working Group</strong></th>
<th align="center"><strong>Supervisors </strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Alexandra Dowlin (AlexandraDowlin-NOAA)</td>
<td align="center">Zack Oyafuso (zoyafuso-NOAA)*</td>
<td align="center">Stan Kotwicki (StanKotwicki-NOAA)</td>
</tr>
<tr class="even">
<td align="center">Emily Markowitz (EmilyMarkowitz-NOAA)</td>
<td align="center">Margaret Siple (MargaretSiple-NOAA)</td>
<td align="center">Duane Stevenson (Duane-Stevenson-NOAA)</td>
</tr>
<tr class="odd">
<td align="center">Liz Dawson (liz-dawson-NOAA)</td>
<td align="center">Rebecca Haehn (RebeccaHaehn-NOAA)</td>
<td align="center">Ned Laman (Ned-Laman-NOAA)</td>
</tr>
<tr class="even">
<td align="center">Sarah Friedman (SarahFriedman-NOAA)</td>
<td align="center">Lukas DeFilippo (Lukas-DeFilippo-NOAA)</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Christopher Anderson (ChrisAnderson-NOAA)</td>
<td align="center">Paul von Szalay (vszalay)</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Nancy Roberson (NancyRoberson)</td>
<td align="center">Thaddaeus Buser (ThaddaeusBuser-NOAA)</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">*maintainer</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="legacy">Legacy<a class="anchor" aria-label="anchor" href="#legacy"></a>
</h2>
<p><em>nanos gigantum humeris insidentes</em>: we stand on the shoulders of giants. Here is an non-exhaustive list of people who provided the foundation for many of the functions in this package:</p>
<p>AI-GOA: Michael Martin,</p>
<p>Bering Sea: REM, Jason Conner, Jerry Hoff,</p>
<p>Many of the index calculations are from Wakabayashi et al. (1985):</p>
<p>Wakabayashi, K., R. G. Bakkala, and M. S. Alton. 1985. Methods of the U.S.-Japan demersal trawl surveys, p. 7-29. In R. G. Bakkala and K. Wakabayashi (editors), Results of cooperative U.S.-Japan groundfish investigations in the Bering Sea during May-August 1979. Int. North Pac. Fish. Comm. Bull. 44.</p>
</div>
<div class="section level2">
<h2 id="acronymns">Acronymns<a class="anchor" aria-label="anchor" href="#acronymns"></a>
</h2>
<p>NOAA: National Oceanic and Atmospheric Administration</p>
<p>NMFS: National Marine Fisheries Service</p>
<p>AFSC: Alaska Fisheries Science Center</p>
<p>RACE: Resource Assessment and Conservation Engineering Division</p>
<p>GAP: Groundfish Assessment Program (GAP)</p>
</div>
<div class="section level2">
<h2 id="legal-disclaimer">Legal disclaimer<a class="anchor" aria-label="anchor" href="#legal-disclaimer"></a>
</h2>
<p>This repository is a software product and is not official communication of the National Oceanic and Atmospheric Administration (NOAA), or the United States Department of Commerce (DOC). All NOAA GitHub project code is provided on an ‘as is’ basis and the user assumes responsibility for its use. Any claims against the DOC or DOC bureaus stemming from the use of this GitHub project will be governed by all applicable Federal law. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation, or favoring by the DOC. The DOC seal and logo, or the seal and logo of a DOC bureau, shall not be used in any manner to imply endorsement of any commercial product or activity by the DOC or the United States Government.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>`use_mit_license()`, `use_gpl3_license()` or friends to pick a
    license</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing gapindex</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Zack Oyafuso <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Zack Oyafuso.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
